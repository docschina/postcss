<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostCSS 插件指南 | PostCSS</title>
    <meta name="description" content="PostCSS中文文档">
    <link rel="icon" href="/doc/image/favicon.ico">
    
    <link rel="preload" href="/doc/assets/css/0.styles.4f9f7631.css" as="style"><link rel="preload" href="/doc/assets/js/app.e50e9663.js" as="script"><link rel="preload" href="/doc/assets/js/6.89a5f45d.js" as="script"><link rel="prefetch" href="/doc/assets/js/5.76723d6f.js"><link rel="prefetch" href="/doc/assets/js/2.d512ec45.js"><link rel="prefetch" href="/doc/assets/js/3.7eef38f1.js"><link rel="prefetch" href="/doc/assets/js/4.812a693c.js"><link rel="prefetch" href="/doc/assets/js/7.551bb666.js"><link rel="prefetch" href="/doc/assets/js/8.f89b2cf6.js"><link rel="prefetch" href="/doc/assets/js/9.1b4c9e3e.js"><link rel="prefetch" href="/doc/assets/js/10.3bf4754a.js"><link rel="prefetch" href="/doc/assets/js/11.81f97380.js">
    <link rel="stylesheet" href="/doc/assets/css/0.styles.4f9f7631.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc/" class="home-link router-link-active"><!----> <span class="site-name">PostCSS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc/" class="nav-link">首页</a></div><div class="nav-item"><a href="/doc/api.html" class="nav-link">文档</a></div><div class="nav-item"><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/docschina/postcss/tree/cn/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  翻译
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc/" class="nav-link">首页</a></div><div class="nav-item"><a href="/doc/api.html" class="nav-link">文档</a></div><div class="nav-item"><a href="https://docschina.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/docschina/postcss/tree/cn/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  翻译
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc/guidelines/plugin.html" class="active sidebar-link">PostCSS 插件指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/guidelines/plugin.html#_1-api" class="sidebar-link">1. API</a></li><li class="sidebar-sub-header"><a href="/doc/guidelines/plugin.html#_2-加工" class="sidebar-link">2. 加工</a></li><li class="sidebar-sub-header"><a href="/doc/guidelines/plugin.html#_3-错误" class="sidebar-link">3. 错误</a></li><li class="sidebar-sub-header"><a href="/doc/guidelines/plugin.html#_4-文档" class="sidebar-link">4. 文档</a></li></ul></li><li><a href="/doc/guidelines/runner.html" class="sidebar-link">PostCSS Runner 指南</a></li></ul></div></li><li><a href="/doc/api.html" class="sidebar-link">API文档</a></li><li><a href="/doc/syntax.html" class="sidebar-link">如何编写自定义语法</a></li><li><a href="/doc/plugins.html" class="sidebar-link">PostCSS Plugins</a></li><li><a href="/doc/writing-a-plugin.html" class="sidebar-link">编写一个PostCSS插件</a></li><li><a href="/doc/source-maps.html" class="sidebar-link">PostCSS 和 Source Maps</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="postcss-插件指南"><a href="#postcss-插件指南" aria-hidden="true" class="header-anchor">#</a> PostCSS 插件指南</h1> <p>一个 PostCSS 插件是一个用于接收或从 PostCSS 编译器中转换 CSS 抽象语法树的函数。</p> <p>对所有的 PostCSS 插件，下列的规则都是 <strong>强制的</strong>。</p> <p>另请参阅 [ClojureWerkz的建议] 来了解开源项目。</p> <h2 id="_1-api"><a href="#_1-api" aria-hidden="true" class="header-anchor">#</a> 1. API</h2> <h3 id="_1-1-带有-postcss-前缀的清晰的命名"><a href="#_1-1-带有-postcss-前缀的清晰的命名" aria-hidden="true" class="header-anchor">#</a> 1.1 带有 <code>postcss-</code> 前缀的清晰的命名</h3> <p>插件的用图应该单凭其名字就能清晰知晓。如果你写一个编译器用于 CSS 4 自定义媒体属性，<code>postcss-custom-media</code>会是一个好名字。
如果你写一个插件用于支持 mixins，<code>postcss-mixins</code> 会是一个好名字。</p> <p>前缀 <code>postcss-</code> 显示，该插件是 PostCSS 生态系统的一部份。</p> <p>对于可作为独立工具运行的插件，此规则不是必需的，没有用户必须知道它是由 PostCSS支持的</p> <ul><li>例如，<a href="http://cssnext.io/" target="_blank" rel="noopener noreferrer">cssnext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和<a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener noreferrer">Autoprefixer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ul> <h3 id="_1-2-只做一件事，并将它做好"><a href="#_1-2-只做一件事，并将它做好" aria-hidden="true" class="header-anchor">#</a> 1.2. 只做一件事，并将它做好</h3> <p>不要创建多工具插件。几个小的，单一用途的插件捆绑在一个插件包中通常是更好的解决方案。</p> <p>例如，<a href="http://cssnext.io/" target="_blank" rel="noopener noreferrer">cssnext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 包含许多小插件，每个 W3C 规范对应一个。 <a href="https://github.com/ben-eb/cssnano" target="_blank" rel="noopener noreferrer">cssnano<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 针对每个优化包含一个单独的插件。</p> <h3 id="_1-3-不要使用-mixins"><a href="#_1-3-不要使用-mixins" aria-hidden="true" class="header-anchor">#</a> 1.3. 不要使用 mixins</h3> <p>预处理器如 Compass 会提供一个带有 mixins 的 API。</p> <p>PostCSS 插件则不同。</p> <p>一个插件不能只是 <a href="https://github.com/postcss/postcss-mixins" target="_blank" rel="noopener noreferrer">postcss-mixins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的一组mixins。要实现您的目标，请考虑转换有效的CSS或使用自定义的规则和自定义属性。</p> <h3 id="_1-4-通过-postcss-plugin-创建插件"><a href="#_1-4-通过-postcss-plugin-创建插件" aria-hidden="true" class="header-anchor">#</a> 1.4. 通过 <code>postcss.plugin</code> 创建插件</h3> <p>通过将函数包装在此方法中，你正在接入一个常见的插件API：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> postcss<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'plugin-name'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>opts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 插件代码</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_2-加工"><a href="#_2-加工" aria-hidden="true" class="header-anchor">#</a> 2. 加工</h2> <h3 id="_2-1-插件必须要被测试"><a href="#_2-1-插件必须要被测试" aria-hidden="true" class="header-anchor">#</a> 2.1. 插件必须要被测试</h3> <p>一个像 <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer">Travis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 持续集成服务被推荐用于在不同的环境中测试代码。你（至少）应该在 Node.js 的 <a href="https://github.com/nodejs/LTS" target="_blank" rel="noopener noreferrer">active LTS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>  和当前稳定版本中测试。</p> <h3 id="_2-2-如有可能请使用异步方法"><a href="#_2-2-如有可能请使用异步方法" aria-hidden="true" class="header-anchor">#</a> 2.2. 如有可能请使用异步方法</h3> <p>譬如，使用 <code>fs.writeFile</code> 而不是 <code>fs.writeFileSync</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>postcss<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'plugin-sprite'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>opts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> sprite <span class="token operator">=</span> <span class="token function">makeSprite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>file<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> err <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-3-为新的节点设置-node-source"><a href="#_2-3-为新的节点设置-node-source" aria-hidden="true" class="header-anchor">#</a> 2.3. 为新的节点设置 <code>node.source</code></h3> <p>每一个节点必须有一个相关的 <code>source</code>，那样 PostCSS 才能生成一个精确的 source map。</p> <p>因此，如果你基本现存的声明新增声明，你应该拷贝现存的声明以保存原有的 <code>source</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">needPrefix</span><span class="token punctuation">(</span>decl<span class="token punctuation">.</span>prop<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    decl<span class="token punctuation">.</span><span class="token function">cloneBefore</span><span class="token punctuation">(</span><span class="token punctuation">{</span> prop<span class="token punctuation">:</span> <span class="token string">'-webkit-'</span> <span class="token operator">+</span> decl<span class="token punctuation">.</span>prop <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你也可以直接设置 <code>source</code>，从现存的节点中复制：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> decl<span class="token punctuation">.</span>prop <span class="token operator">===</span> <span class="token string">'animation'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> keyframe <span class="token operator">=</span> <span class="token function">createAnimationByName</span><span class="token punctuation">(</span>decl<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyframes<span class="token punctuation">.</span>source <span class="token operator">=</span> decl<span class="token punctuation">.</span>source<span class="token punctuation">;</span>
    decl<span class="token punctuation">.</span><span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>keyframes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-4-请只使用公开的-postcss-api"><a href="#_2-4-请只使用公开的-postcss-api" aria-hidden="true" class="header-anchor">#</a> 2.4. 请只使用公开的 PostCSS API</h3> <p>PostCSS插件不能依赖于未记录的属性或方法，在任何次要版本中可能会有所变化。公共API
在<a href="http://api.postcss.org/" target="_blank" rel="noopener noreferrer">API docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中描述。</p> <h2 id="_3-错误"><a href="#_3-错误" aria-hidden="true" class="header-anchor">#</a> 3. 错误</h2> <h3 id="_3-1-对-css-相关错误使用node-error"><a href="#_3-1-对-css-相关错误使用node-error" aria-hidden="true" class="header-anchor">#</a> 3.1. 对 CSS 相关错误使用<code>node.error</code></h3> <p>如果由于输入CSS而导致错误（如未知名称）在mixin插件中）你应该使用<code>node.error</code>来创建一个错误
包括来源位置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> mixins<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> decl<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Unknown mixin '</span> <span class="token operator">+</span> name<span class="token punctuation">,</span> <span class="token punctuation">{</span> plugin<span class="token punctuation">:</span> <span class="token string">'postcss-mixins'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-2-对警告使用-result-warn"><a href="#_3-2-对警告使用-result-warn" aria-hidden="true" class="header-anchor">#</a> 3.2. 对警告使用 <code>result.warn</code></h3> <p>请不要用 <code>console.log</code> 或者 <code>console.warn</code> 输出警告, 因为有些 PostCSS runner 可能不允许 console 的输出。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">outdated</span><span class="token punctuation">(</span>decl<span class="token punctuation">.</span>prop<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>decl<span class="token punctuation">.</span>prop <span class="token operator">+</span> <span class="token string">' is outdated'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> node<span class="token punctuation">:</span> decl <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果 CSS 的输入是警告的来源，插件应该设置 <code>node</code> 选项。</p> <h2 id="_4-文档"><a href="#_4-文档" aria-hidden="true" class="header-anchor">#</a> 4. 文档</h2> <h3 id="_4-1-用英文给你的插件写文档"><a href="#_4-1-用英文给你的插件写文档" aria-hidden="true" class="header-anchor">#</a> 4.1. 用英文给你的插件写文档</h3> <p>PostCSS 插件必须用英文写好 &quot;README.md&quot;。不要害怕你的英语技能，因为开源社区将会修复你的错误。</p> <p>当然，也欢迎你用其它语言写文档，但请恰当地对文件全名（比如：<code>README.ja.md</code>）</p> <h3 id="_4-2-包括输入与输出例子"><a href="#_4-2-包括输入与输出例子" aria-hidden="true" class="header-anchor">#</a> 4.2. 包括输入与输出例子</h3> <p>插件的 <code>README.md</code> 必须包括输入与输出的 CSS。一个清楚的例子是最好的描述你的插件运行的办法。</p> <p><code>README.md</code> 的第一部份是放置例子的好地方。看 <a href="https://github.com/iamvdo/postcss-opacity" target="_blank" rel="noopener noreferrer">postcss-opacity<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 为例。</p> <p>当然，如果你的插件不是用于转换 CSS，则本指引将不适用于你的插件。</p> <h3 id="_4-3-维护一个变更日志"><a href="#_4-3-维护一个变更日志" aria-hidden="true" class="header-anchor">#</a> 4.3. 维护一个变更日志</h3> <p>PostCSS 插件必须在一个单独的文件里，例如<code>CHANGELOG.md</code>, <code>History.md</code>, 或 <a href="https://help.github.com/articles/creating-releases/" target="_blank" rel="noopener noreferrer">GitHub Releases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 描述它们所有的变更。访问 <a href="http://keepachangelog.com/" target="_blank" rel="noopener noreferrer">Keep A Changelog<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 获取更多有关如何写变更日志的信息。</p> <p>当然，你应该使用 <a href="http://semver.org/" target="_blank" rel="noopener noreferrer">SemVer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 描述版本号.</p> <h3 id="_4-4-在-package-json-包含-postcss-plugin-关键词"><a href="#_4-4-在-package-json-包含-postcss-plugin-关键词" aria-hidden="true" class="header-anchor">#</a> 4.4. 在 <code>package.json</code> 包含 <code>postcss-plugin</code> 关键词</h3> <p>将 PostCSS 插件写成 npm 类库必须在 <code>package.json</code> 中包含 <code>postcss-plugin</code> 关键词。这个特别的关键词将对 PostCSS 生态的反馈非常有用。</p> <p>那些没被发布到 npm 平台的插件，这个不是强制的，但建议采纳如果插件格式能包括该关键词。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/doc/guidelines/runner.html">
          PostCSS Runner 指南
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/doc/assets/js/6.89a5f45d.js" defer></script><script src="/doc/assets/js/app.e50e9663.js" defer></script>
  </body>
</html>
